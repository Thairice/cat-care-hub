# Story 1.7: Deploy to Vercel with Continuous Deployment

## Status
**In Progress**

---

## Story

**As a** developer,
**I want** the application automatically deployed to Vercel on every Git push,
**so that** changes are immediately visible in production and stakeholders can review progress.

---

## Acceptance Criteria

1. Vercel account created and connected to GitHub repository
2. Next.js project deployed to Vercel with production URL
3. Environment variables (Contentful API keys) configured in Vercel dashboard
4. Automatic deployments triggered on push to main branch
5. Preview deployments created for pull requests (if using PR workflow)
6. Production site successfully displays home page with Contentful content
7. HTTPS enabled by default on Vercel deployment
8. Custom domain setup documented (optional for MVP, can be added later)
9. Deployment status visible in GitHub (Vercel bot comments on commits/PRs)

---

## Tasks / Subtasks

- [ ] Create Vercel account (AC: 1)
  - [ ] Go to https://vercel.com/signup
  - [ ] Sign up with GitHub account (recommended)
  - [ ] Authorize Vercel to access GitHub

- [ ] Import GitHub repository (AC: 1, 2)
  - [ ] Click "Add New Project" or "Import Project"
  - [ ] Select the cat-care-hub repository
  - [ ] Configure project settings (Framework: Next.js should auto-detect)
  - [ ] Set root directory to `apps/web` (monorepo setup)

- [ ] Configure environment variables (AC: 3)
  - [ ] In Vercel project settings → Environment Variables
  - [ ] Add CONTENTFUL_SPACE_ID
  - [ ] Add CONTENTFUL_ACCESS_TOKEN
  - [ ] Add CONTENTFUL_PREVIEW_ACCESS_TOKEN
  - [ ] Select environments: Production, Preview, Development

- [ ] Deploy to production (AC: 2, 7)
  - [ ] Click "Deploy"
  - [ ] Wait for build to complete
  - [ ] Verify deployment success
  - [ ] Copy production URL
  - [ ] Visit production URL and verify site loads

- [ ] Verify Contentful integration (AC: 6)
  - [ ] Check if articles display on home page
  - [ ] If not displaying, debug Contentful content type identifier
  - [ ] Verify all pages load correctly

- [ ] Enable automatic deployments (AC: 4, 5, 9)
  - [ ] Verify GitHub integration is active
  - [ ] Make a small change and push to main branch
  - [ ] Verify automatic deployment triggers
  - [ ] Check GitHub for Vercel bot comment

- [ ] Document deployment (AC: 8)
  - [ ] Save production URL
  - [ ] Document environment variables needed
  - [ ] Note any deployment-specific configurations

---

## Dev Notes

### Vercel Account Setup

**Sign up at:** https://vercel.com/signup

**Recommended:** Sign up with GitHub account for easier integration

### Project Configuration

**Framework Preset:** Next.js (should auto-detect)
**Root Directory:** `apps/web` (important for monorepo structure!)
**Build Command:** `npm run build` (default)
**Output Directory:** `.next` (default)
**Install Command:** `npm install` (default)

### Environment Variables

Add these in Vercel Dashboard → Project Settings → Environment Variables:

```
CONTENTFUL_SPACE_ID=plfh3lxdrg91
CONTENTFUL_ACCESS_TOKEN=RNZTcuX-XfP2kOC1-RSq48oUD2zOXvDeNtkUoUUJTt4
CONTENTFUL_PREVIEW_ACCESS_TOKEN=iwKuELIAa7MCckINmw4yeiwedA5ndQe7mW2_WjuKpzk
```

**Important:** Add to all environments (Production, Preview, Development)

### Deployment Process

1. **Initial Deploy:**
   - Vercel will build and deploy automatically
   - Build time: ~2-3 minutes
   - Production URL will be: `https://cat-care-hub.vercel.app` (or similar)

2. **Automatic Deployments:**
   - Push to `main` branch → Production deployment
   - Push to other branches → Preview deployment
   - Pull requests → Preview deployment with unique URL

3. **Build Settings:**
   - Vercel automatically detects Next.js
   - No special configuration needed
   - Environment variables injected at build time

### Vercel Features Included

✅ **HTTPS** - Automatic SSL certificates
✅ **CDN** - Global edge network
✅ **Automatic scaling** - Handles traffic spikes
✅ **Analytics** - Basic analytics included (free tier)
✅ **Preview deployments** - For PRs and branches
✅ **Zero-config** - Works out of the box with Next.js

### Common Issues and Solutions

**Issue: Build fails with "Cannot find module"**
- Solution: Check `package.json` dependencies are correct
- Ensure root directory is set to `apps/web`

**Issue: Environment variables not working**
- Solution: Redeploy after adding environment variables
- Check variable names match exactly (case-sensitive)

**Issue: Contentful articles not showing**
- Solution: Verify API keys are correct
- Check Contentful content type identifier matches code

**Issue: 404 on custom paths**
- Solution: Next.js App Router handles this automatically
- No additional configuration needed

### Custom Domain (Optional)

To add a custom domain later:
1. Go to Project Settings → Domains
2. Add your domain (e.g., `catcarehub.com`)
3. Follow DNS configuration instructions
4. Vercel handles SSL automatically

**Note:** Custom domain not required for MVP

### Monitoring

**Deployment Logs:**
- View in Vercel Dashboard → Deployments → Click deployment → Logs

**Runtime Logs:**
- View in Vercel Dashboard → Functions → Select function → Logs

**Analytics:**
- View in Vercel Dashboard → Analytics

### Testing

**Manual Testing:**
1. Visit production URL
2. Verify home page loads with hero section
3. Check header and footer display
4. Verify navigation links work
5. Check articles display (if Contentful is configured correctly)
6. Test on mobile device

**No automated tests required for deployment**

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial story creation | Dev Agent |

---

## Dev Agent Record

### Agent Model Used
*To be populated by dev agent*

### Debug Log References
*To be populated by dev agent*

### Completion Notes List
*To be populated by dev agent*

### File List
*To be populated by dev agent*

---

## QA Results

*To be populated by QA agent*
